//---------------------------------------------------------------------------

#include <vcl.h>
#pragma hdrstop

#include "EnulatorLibTestMain.h"
#include "EmuServiceUtil.h"

//---------------------------------------------------------------------------
#pragma package(smart_init)
#pragma resource "*.dfm"
TForm1 *Form1;
CEmuService *m_emu_executor;
bool btemp =false;
//---------------------------------------------------------------------------
__fastcall TForm1::TForm1(TComponent* Owner)
    : TForm(Owner)
{
}
//---------------------------------------------------------------------------
void __fastcall TForm1::Button1Click(TObject *Sender)
{
     TStrings * m_Params = new TStringList();
     m_Params->Text = AnsiReplaceStr(Edit1->Text,";","\n");
     m_emu_executor = new CEmuService( m_Params );
}
//---------------------------------------------------------------------------
void __fastcall TForm1::Button2Click(TObject *Sender)
{
    m_emu_executor->ExecService( Edit2->Text.c_str() , Edit3->Text.c_str(),Edit4->Text.c_str() , true , btemp , NULL ) ;
}
//---------------------------------------------------------------------------
void __fastcall TForm1::Timer1Timer(TObject *Sender)
{
    if ( CheckBox1->Checked ) Button2Click( NULL ) ;
}
//---------------------------------------------------------------------------
void __fastcall TForm1::CheckBox1Click(TObject *Sender)
{
    Timer1->Enabled = CheckBox1->Checked ;
}
//---------------------------------------------------------------------------
